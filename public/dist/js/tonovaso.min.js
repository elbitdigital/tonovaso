var Dialog=function(){function t(t){var e=this;this.element=t,this.show=function(){e.element.classList.add("is-active")},this.hide=function(){e.element.classList.remove("is-active")},this.setText=function(t){var n=e.element.querySelector(".Dialog-text");if(n){n.innerHTML="";var i=document.createElement("span");i.textContent=t,n.appendChild(i)}},this.setSubText=function(t){var n=e.element.querySelector(".Dialog-subText");if(n){n.innerHTML="";var i=document.createElement("span");i.textContent=t,n.appendChild(i)}},this.element&&this.init()}return t.prototype.init=function(){},t}(),Select=function(){function t(t,e){this.element=t,this.fallback=e,this.config={innerElementSelector:".Select-inner",valueElementSelector:".Select-value",selectElementSelector:".Select-select"},this.element&&this.init()}return t.prototype.updateValue=function(){var t=this;try{this.value=this.selectElement.value,this.valueElement.innerHTML="";var e=document.createElement("span");e.innerText=this.selectElement.value,this.valueElement.appendChild(e),setTimeout(function(){t.fallback&&t.fallback(t.value)})}catch(n){}},t.prototype.addListeners=function(){var t=this;try{this.selectElement.addEventListener("focus",function(){t.element.classList.add("is-focus")}),this.selectElement.addEventListener("blur",function(){t.element.classList.remove("is-focus")}),this.selectElement.addEventListener("keydown",function(){setTimeout(function(){t.updateValue()},1)}),this.selectElement.addEventListener("change",function(){t.updateValue()})}catch(e){console.log(e)}},t.prototype.getElements=function(){this.innerElement=this.element.querySelector(this.config.innerElementSelector),this.valueElement=this.element.querySelector(this.config.valueElementSelector),this.selectElement=this.element.querySelector(this.config.selectElementSelector)},t.prototype.init=function(){this.getElements(),this.addListeners(),this.updateValue()},t}(),TicketsCheckout=function(){function t(t,e){this.element=t,this.parent=e,this.config={priceAmountElementSelector:".TicketsCheckout-amount",quantityElementSelector:".TicketsCheckout-quantity",startButtonElementSelector:".TicketsCheckout-start"},this.amount="",this.quantity="",this.element&&this.parent&&this.init()}return t.prototype.start=function(){for(var t=this,e=[],n=this.parent.options.length;n--;)if(this.parent.options[n].quantity){var i={id:this.parent.options[n].id,description:this.parent.options[n].description,amount:this.parent.options[n].price,quantity:this.parent.options[n].quantity};e.push(i)}if(firebase){var s=firebase.database().ref("transactions/"),o={items:e,reference:s.push(e).key};s.child(o.reference).set(o),$.ajax({crossDomain:!0,url:"https://service.elbit.com.br/dalia-server/index.php",type:"POST",cache:!1,data:{pedido:JSON.stringify(o)},beforeSend:function(){t.parent.dialog.setText("Aguarde, estamos te redirecionando para uma p√°gina segura de pagamento"),t.parent.dialog.show()},success:function(t){console.log(t),setTimeout(function(){t.url&&window.location.replace(t.url)},2e3)}})}},t.prototype.convertToComma=function(t){return t.toString().replace(".",",")},t.prototype.getQuantity=function(){for(var t=0,e=this.parent.options.length;e--;)t+=this.parent.options[e].quantity;return t},t.prototype.getPriceAmount=function(){for(var t=0,e=this.parent.options.length;e--;)t+=this.parent.options[e].quantity*this.parent.options[e].price;return parseFloat(t).toFixed(2)},t.prototype.updatePriceAmount=function(){this.priceAmountElement.innerHTML="";var t=document.createElement("span");t.textContent="R$"+this.convertToComma(this.getPriceAmount()),this.priceAmountElement.appendChild(t)},t.prototype.updateQuantity=function(){this.quantityElement.innerHTML="";var t=document.createElement("span");t.textContent="QTD: "+this.getQuantity(),this.quantityElement.appendChild(t)},t.prototype.updateDetails=function(){this.updatePriceAmount(),this.updateQuantity()},t.prototype.addListeners=function(){var t=this;try{this.startButtonElement.addEventListener("click",function(){t.start()})}catch(e){}},t.prototype.getElements=function(){this.quantityElement=this.element.querySelector(this.config.quantityElementSelector),this.priceAmountElement=this.element.querySelector(this.config.priceAmountElementSelector),this.startButtonElement=this.element.querySelector(this.config.startButtonElementSelector)},t.prototype.init=function(){this.getElements(),this.addListeners(),this.updatePriceAmount()},t}(),TicketsOption=function(){function t(t,e){var n=this;this.element=t,this.parent=e,this.config={showMoreElementSelector:".TicketsOptions-showMore",showLessElementSelector:".TicketsOptions-showLess",showingMoreStateClass:"is-showingMore",selectElementSelector:".Select.Select--ticketOption"},this.quantity=0,this.id=this.element.dataset.optionId||"",this.description=this.element.dataset.description||"",this.price=this.getPrice(),this.onSelectChange=function(t){try{n.quantity=parseInt(t),n.parent.onOptionQuantityChange()}catch(e){}},this.element&&this.init()}return t.prototype.addListeners=function(){var t=this;try{this.showMore.addEventListener("click",function(e){e.preventDefault(),t.element.classList.add(t.config.showingMoreStateClass)}),this.showLess.addEventListener("click",function(e){e.preventDefault(),t.element.classList.remove(t.config.showingMoreStateClass)})}catch(e){console.log(e)}},t.prototype.getElements=function(){var t=this;this.showLess=this.element.querySelector(this.config.showLessElementSelector),this.showMore=this.element.querySelector(this.config.showMoreElementSelector);var e=this.element.querySelector(this.config.selectElementSelector);e&&(this.select=new Select(e,t.onSelectChange))},t.prototype.getPrice=function(){try{return this.element.dataset.price?parseFloat(this.element.dataset.price).toFixed(2):0}catch(t){return 0}},t.prototype.init=function(){this.getElements(),this.addListeners()},t}(),Tickets=function(){function t(t){var e=this;this.element=t,this.config={optionElementSelector:".TicketsOption",checkoutElementSelector:".Tickets-checkout"},this.options=[],this.onOptionQuantityChange=function(){e.checkout.updateDetails();for(var t=0,n=e.options.length;n--;)t+=e.options[n].quantity;0==t?e.element.classList.add("is-empty"):e.element.classList.remove("is-empty")},this.element&&this.init()}return t.prototype.getElements=function(){var t=this.element.querySelector(this.config.checkoutElementSelector);t&&(this.checkout=new TicketsCheckout(t,this))},t.prototype.getOptions=function(){for(var t=this.element.querySelectorAll(this.config.optionElementSelector),e=t.length;e--;)this.options.push(new TicketsOption(t[e],this))},t.prototype.init=function(){this.getOptions(),this.getElements()},t}();