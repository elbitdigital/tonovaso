var Anchor=function(){function e(e,t){var i=this;this.element=e,_.defaults(t,{duration:200,easing:"linear",callback:!1,scrollOffset:0}),this.duration=t.duration,this.easing=t.easing,this.callback=t.callback,this.scrollOffset=t.scrollOffset,this.push=function(){i.start=this.bodyElement.scrollTop,i.startTime=Date.now(),i.documentHeight=i.getDocumentHeight(),i.windowHeight=i.getWindowHeight(),i.destinationPosition=i.getDestinationPosition(),i.animate()},this.element&&this.init()}return e.prototype.checkBody=function(){document.documentElement.scrollTop+=1;var e=0!==document.documentElement.scrollTop?document.documentElement:document.body;return document.documentElement.scrollTop-=1,e},e.prototype.easingOption=function(e,t){switch(e){case"linear":return t;case"easeInQuad":return t*t;case"easeOutQuad":return t*(2-t);case"easeInOutQuad":return t<.5?2*t*t:-1+(4-2*t)*t;case"easeInCubic":return t*t*t;case"easeOutCubic":return--t*t*t+1;case"easeInOutCubic":return t<.5?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1;case"easeInQuart":return t*t*t*t;case"easeOutQuart":return 1- --t*t*t*t;case"easeInOutQuart":return t<.5?8*t*t*t*t:1-8*--t*t*t*t;case"easeInQuint":return t*t*t*t*t;case"easeOutQuint":return 1+--t*t*t*t*t;case"easeInOutQuint":return t<.5?16*t*t*t*t*t:1+16*--t*t*t*t*t;default:return t*t}},e.prototype.animate=function(){var e=this,t=Date.now(),i=Math.min(1,(t-this.startTime)/this.duration),n=this.easingOption(this.easing,i);this.bodyElement.scrollTop=n*(this.destinationPosition-this.start)+this.start,this.bodyElement.scrollTop!==this.destinationPosition&&requestAnimationFrame(function(){e.animate()})},e.prototype.getDestinationPosition=function(){return(this.documentHeight-this.element.offsetTop<this.windowHeight?this.documentHeight-this.windowHeight:this.element.offsetTop)+this.scrollOffset},e.prototype.getWindowHeight=function(){return window.innerHeight||document.documentElement.clientHeight||document.getElementsByTagName("body")[0].clientHeight},e.prototype.getDocumentHeight=function(){return Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)},e.prototype.init=function(){this.bodyElement=this.checkBody()},e}(),Dialog=function(){function e(e){var t=this;this.element=e,this.show=function(){t.element.classList.add("is-active")},this.hide=function(){t.element.classList.remove("is-active")},this.setText=function(e){var i=t.element.querySelector(".Dialog-text");if(i){i.innerHTML="";var n=document.createElement("span");n.textContent=e,i.appendChild(n)}},this.setSubText=function(e){var i=t.element.querySelector(".Dialog-subText");if(i){i.innerHTML="";var n=document.createElement("span");n.textContent=e,i.appendChild(n)}},this.element&&this.init()}return e.prototype.init=function(){},e}(),LineupArtist=function(){function e(e){this.element=e,this.config={showMoreButtonElementSelector:".Button--lineupShowMore"},this.element&&this.init()}return e.prototype.addListeners=function(){var e=this;try{this.showMoreButtonElement&&this.showMoreButtonElement.addEventListener("click",function(){e.element.classList.toggle("is-showingMore")})}catch(t){}},e.prototype.getElements=function(){this.showMoreButtonElement=this.element.querySelector(this.config.showMoreButtonElementSelector)},e.prototype.init=function(){this.getElements(),this.addListeners(),console.log(this.showMoreButtonElement)},e}(),OrderItem=function(){function e(e,t){e&&(this.clientName=e.clientName,this.clientEmail=e.clientEmail,this.code=e.code,this.date=e.date,this.items=e.items,this.reference=e.reference,this.status=e.status,this.time=e.time,this.tickets=e.tickets,this.normalizeData(),this.createElement(),this.getTicketList())}return e.prototype.setClientName=function(e){this.clientName=e,database.ref("transactions/"+this.reference).child("clientName").set(this.clientName)},e.prototype.setClientEmail=function(e){this.clientEmail=e,database.ref("transactions/"+this.reference).child("clientEmail").set(this.clientEmail)},e.prototype.setCode=function(e){this.code=e,database.ref("transactions/"+this.reference).child("code").set(this.code)},e.prototype.setDate=function(e){this.date=moment(e).format(),database.ref("transactions/"+this.reference).child("date").set(this.date)},e.prototype.setStatus=function(e){this.status=e,database.ref("transactions/"+this.reference).child("status").set(this.status)},e.prototype.setTime=function(e){this.time=e,database.ref("transactions/"+this.reference).child("time").set(this.time)},e.prototype.getTicketList=function(){this.ticketList=new OrderTicketList(this.ticketListElement,this)},e.prototype.normalizeData=function(){if(!this.tickets)for(var e=this.items.length;e--;)if("TNVABADA"!=this.items[e].id&&this.items[e].quantity>0)for(var t=this.items[e].quantity;t--;){var i=database.ref("transactions/"+this.reference).child("tickets").push().key;database.ref("transactions/"+this.reference).child("tickets").child(i).set({amount:this.items[e].amount,description:this.items[e].description,id:this.items[e].id,reference:i})}},e.prototype.defineStatusColor=function(e){switch(e){case"Aprovada":return"font-green-400";case"Cancelada":return"font-red-400";case"Aguardando pagamento":return"font-yellow-700";case"Pagamento negado pela empresa de cartão de crédito":return"font-red-400";default:return"font-grey-400"}},e.prototype.createElement=function(){var e=this;this.element=document.createElement("div"),this.element.className="OrderItem",this.element.dataset.itemReferenceId=this.reference,this.headerElement=document.createElement("div"),this.headerElement.className="OrderItem-header",this.headerElement.dataset.itemReferenceId=this.reference,this.element.appendChild(this.headerElement),this.bodyElement=document.createElement("div"),this.bodyElement.className="OrderItem-body",this.bodyElement.dataset.itemReferenceId=this.reference,this.element.appendChild(this.bodyElement),this.referenceLabelElement=document.createElement("div"),this.referenceLabelElement.className="OrderItem-referenceLabel "+this.defineStatusColor(this.status),this.referenceLabelElement.innerHTML="<span>"+this.reference+" ("+this.status+")</span>",this.referenceLabelElement.dataset.itemReferenceId=this.reference,this.headerElement.appendChild(this.referenceLabelElement),this.clientNameLabelElement=document.createElement("input"),this.clientNameLabelElement.className="OrderItem-clientNameField",this.clientNameLabelElement.placeholder="Nome (titular)",this.clientNameLabelElement.value=this.clientName,this.clientNameLabelElement.dataset.itemReferenceId=this.reference,this.clientNameLabelElement.addEventListener("input",function(){if(this.dataset.itemReferenceId){var e=this.value.length?this.value:null;database.ref("transactions/"+this.dataset.itemReferenceId).child("clientName").set(e)}}),this.headerElement.appendChild(this.clientNameLabelElement),this.dateLabelElement=document.createElement("span"),this.dateLabelElement.className="OrderItem-dateLabel",this.dateLabelElement.innerText=moment(this.date).format("LLL")||"",this.dateLabelElement.dataset.itemReferenceId=this.reference,this.bodyElement.appendChild(this.dateLabelElement),this.codeLabelElement=document.createElement("span"),this.codeLabelElement.className="OrderItem-codeLabel",this.codeLabelElement.innerText=this.code||"",this.codeLabelElement.dataset.itemReferenceId=this.reference,this.bodyElement.appendChild(this.codeLabelElement),this.clientEmailLabelElement=document.createElement("span"),this.clientEmailLabelElement.className="OrderItem-clientEmailLabel",this.clientEmailLabelElement.innerText=this.clientEmail||"",this.clientEmailLabelElement.dataset.itemReferenceId=this.reference,this.bodyElement.appendChild(this.clientEmailLabelElement),this.ticketListElement=document.createElement("div"),this.ticketListElement.className="OrderTicketList",this.ticketListElement.dataset.itemReferenceId=this.reference,this.bodyElement.appendChild(this.ticketListElement),this.showMoreButtonElement=document.createElement("button"),this.showMoreButtonElement.className="OrderItem-showMore",this.showMoreButtonElement.innerHTML="<span>Mostrar mais</span>",this.showMoreButtonElement.addEventListener("click",function(){e.element.classList.toggle("is-showingMore"),e.element.classList.contains("is-showingMore")?this.innerHTML="<span>Mostrar menos</span>":this.innerHTML="<span>Mostrar mais</span>"}),this.element.appendChild(this.showMoreButtonElement)},e}(),OrderList=function(){function e(e,t){this.element=e,this.database=t,this.locked=!0,this.list=[],this.viewList=[],this.config={orderType:"time",orderReverse:!1,approvedOnly:!0,hiddenCanceled:!0}}return e.prototype.build=function(e){function t(e){i.element.appendChild(e)}if(e=e?e.toLowerCase():"",this.element.innerHTML="",!this.locked){this.viewList.length||this.buildViewList();for(var i=this,n=0;n<this.viewList.length;n++)if(this.list[n].status){var s=!1;this.list[n].clientName&&(s=this.list[n].clientName.toLowerCase().includes(e)),this.config.hiddenCanceled&&!e.length&&("Cancelada"!=this.list[n].status&&"Pagamento negado pela empresa de cartão de crédito"!=this.list[n].status||(s=!1)),s&&t(this.list[n].element)}}},e.prototype.buildViewList=function(){var e=this.list;e.sort(function(e,t){return e.clientName>t.clientName?1:e.clientName<t.clientName?-1:0}),this.viewList=e},e.prototype.isInList=function(e){var t=this.list.filter(function(t){return t.reference==e.reference});return!!t.length},e.prototype.push=function(e){this.isInList(e)||this.list.push(e)},e.prototype.start=function(){var e=this;this.database.ref("transactions/").on("child_added",function(t){var i=new OrderItem(t.val());e.push(i),document.getElementById("orderList-count").innerText=e.list.length+" registro processados",e.locked||(e.buildViewList(),e.build()),t.val().reference||console.log(t.key)}),setTimeout(function(){e.locked=!1,e.build()},3e3)},e}(),OrderTicketItem=function(){function e(e,t){var i=this;e&&t&&(this.orderItem=t,this.reference=e.reference,this.id=e.id,this.amount=e.amount,this.description=e.description,this.shipping=e.shipping,this.createElement(),database.ref("transactions/"+this.orderItem.reference+"/tickets/"+this.reference+"/").child("shipping").on("value",function(e){i.updateShippingStatus(e.val())}))}return e.prototype.updateShippingStatus=function(e){this.shipping=e,this.shipping?(this.element.classList.add("is-shipped"),this.shippingButtonElement.innerHTML="<span>Retirado</span>"):(this.element.classList.remove("is-shipped"),this.shippingButtonElement.innerHTML="<span>Retirar</span>")},e.prototype.getTicketTypeColor=function(e){var t="font-indigo-700",i="font-pink-700";switch(e){case"TNVPACKPROMO_M":return t;case"TNVPACKPROMO_F":return i;case"TNVPACK_M":return t;case"TNVPACK_F":return i;case"TNVDIAR_M":return t;case"TNVDIAR_F":return i;default:return"grey-700"}},e.prototype.createElement=function(){var e=this;this.element=document.createElement("div"),this.element.className="OrderTicketItem",this.element.dataset.itemReferenceId=this.reference,this.idLabelElement=document.createElement("span"),this.idLabelElement.className="OrderTicketItem-id",this.idLabelElement.innerText=this.id+"",this.descriptionLabelElement=document.createElement("span"),this.descriptionLabelElement.className="OrderTicketItem-description",this.descriptionLabelElement.innerText=this.description+"",this.descriptionLabelElement.classList.add(this.getTicketTypeColor(this.id)),this.element.appendChild(this.descriptionLabelElement),this.shippingButtonElement=document.createElement("span"),this.shippingButtonElement.className="OrderTicketItem-shippingButton",this.shippingButtonElement.innerHTML="<span>Retirar</span>",this.shippingButtonElement.addEventListener("click",function(){if(e.shipping)if(window.isSuperUser){if(window.confirm("Você está prestes a anular a retirada deste ticket, você confirma isso?")){var t=firebase.auth().currentUser,i={timestamp:moment().format(),user:{displayName:t.displayName,email:t.email,uid:t.uid}};database.ref("transactions/"+e.orderItem.reference+"/tickets/"+e.reference+"/").child("shipping").set(!1),i.reference=e.reference,i.type="unshipped",database.ref("ticketShippings/").push(i)}}else console.log("sorry");else if(window.confirm("Você confirma a retirada deste ingresso?")){var t=firebase.auth().currentUser,n=prompt("Qual o Nome da pessoa que está retirando?"),s=prompt("Qual o CPF da pessoa que está retirando?"),i={cpf:s,name:n,timestamp:moment().format(),user:{displayName:t.displayName,email:t.email,uid:t.uid}};database.ref("transactions/"+e.orderItem.reference+"/tickets/"+e.reference+"/").child("shipping").set(i),i.reference=e.reference,i.type="shipped",database.ref("ticketShippings/").push(i)}}),this.element.appendChild(this.shippingButtonElement)},e}(),OrderTicketList=function(){function e(e,t){var i=this;this.element=e,this.orderItem=t,this.list=[],this.orderItem&&this.element&&database.ref("transactions/"+this.orderItem.reference+"/tickets/").on("child_added",function(e){var t=new OrderTicketItem(e.val(),i.orderItem);i.push(t)})}return e.prototype.build=function(){this.element.innerHTML="";for(var e=this.list.length;e--;)this.element.appendChild(this.list[e].element)},e.prototype.push=function(e){this.list.push(e),this.build()},e}(),Player=function(){function e(e){var t=this;this.element=e,this.video=!1,this.config={backgroundElementSelector:".Player-background",innerElementSelector:".Player-inner",selectAreaElementSelector:".Player-selectArea"},this.pause=function(){t.video&&t.video.pause()},this.play=function(){t.video&&t.video.play()},this.stop=function(){t.video&&t.video.stop()},this.power=function(){var e=document.createElement("script");e.src="https://www.youtube.com/iframe_api";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)},this.element&&this.init()}return e.prototype.setVideo=function(e){this.video=e,this.video.elementID=this.element.id,this.backgroundElement?this.backgroundElement.style.backgroundImage="url(https://i.ytimg.com/vi/"+this.video.id+"/hqdefault.jpg)":this.element.style.backgroundImage="url(https://i.ytimg.com/vi/"+this.video.id+"/hqdefault.jpg)"},e.prototype.addControl=function(e,t){var i=this;switch(e){case"pause":i.addControlListener(t,i.pause);break;case"play":i.addControlListener(t,i.play);break;case"power":i.addControlListener(t,i.power);break;case"stop":i.addControlListener(t,i.stop);break;default:i.addControlListener(t,i.play)}},e.prototype.addControlListener=function(e,t){try{e.addEventListener("click",t)}catch(i){e&&e.attachEvent("onclick",t)}},e.prototype.getElements=function(){this.backgroundElement=this.element.querySelector(this.config.backgroundElementSelector),this.innerElement=this.element.querySelector(this.config.innerElementSelector),this.selectAreaElement=this.element.querySelector(this.config.selectAreaElementSelector)},e.prototype.addListeners=function(){var e=this;this.selectAreaElement?e.addControlListener(this.selectAreaElement,e.power):e.addControlListener(this.element,e.power)},e.prototype.init=function(){this.getElements(),this.addListeners()},e}(),Select=function(){function e(e,t){this.element=e,this.fallback=t,this.config={innerElementSelector:".Select-inner",valueElementSelector:".Select-value",selectElementSelector:".Select-select"},this.element&&this.init()}return e.prototype.updateValue=function(){var e=this;try{this.value=this.selectElement.value,this.valueElement.innerHTML="";var t=document.createElement("span");t.innerText=this.selectElement.value,this.valueElement.appendChild(t),setTimeout(function(){e.fallback&&e.fallback(e.value)},1)}catch(i){}},e.prototype.addListeners=function(){var e=this;try{this.selectElement.addEventListener("focus",function(){e.element.classList.add("is-focus")}),this.selectElement.addEventListener("blur",function(){e.element.classList.remove("is-focus")}),this.selectElement.addEventListener("keydown",function(){setTimeout(function(){e.updateValue()},1)}),this.selectElement.addEventListener("change",function(){e.updateValue()})}catch(t){console.log(t)}},e.prototype.getElements=function(){this.innerElement=this.element.querySelector(this.config.innerElementSelector),this.valueElement=this.element.querySelector(this.config.valueElementSelector),this.selectElement=this.element.querySelector(this.config.selectElementSelector)},e.prototype.init=function(){this.getElements(),this.addListeners(),this.updateValue()},e}(),TicketsCheckout=function(){function e(e,t){this.element=e,this.parent=t,this.config={priceAmountElementSelector:".TicketsCheckout-amount",quantityElementSelector:".TicketsCheckout-quantity",startButtonElementSelector:".TicketsCheckout-start"},this.amount="",this.quantity="",this.element&&this.parent&&this.init()}return e.prototype.start=function(){for(var e=this,t=[],i=this.parent.options.length;i--;)if(this.parent.options[i].quantity){var n={id:this.parent.options[i].id,description:this.parent.options[i].description,amount:this.parent.options[i].price,quantity:this.parent.options[i].quantity};t.push(n)}if(t.length&&firebase){var s=firebase.database().ref("transactions/"),o=s.push().key,r=Date.now().toString(),a={items:t,reference:o,time:r};s.child(o).set(a),$.ajax({crossDomain:!0,url:"https://service.elbit.com.br/dalia-server/index.php",type:"POST",cache:!1,data:{pedido:JSON.stringify(a)},beforeSend:function(){e.parent.dialog.setText("Aguarde, estamos te redirecionando para uma página segura de pagamento"),e.parent.dialog.show();try{ga("send","event",{eventCategory:"Ticket",eventAction:"click",eventLabel:"TicketCheckout"})}catch(t){}},success:function(e){try{e.code&&(a.code=e.code,a.date=e.date,console.log(a),console.log(o),s.child(o).set(a))}catch(t){}setTimeout(function(){e.url&&window.location.replace(e.url)},2e3)}})}},e.prototype.convertToComma=function(e){return e.toString().replace(".",",")},e.prototype.getQuantity=function(){for(var e=0,t=this.parent.options.length;t--;)e+=this.parent.options[t].quantity;return e},e.prototype.getPriceAmount=function(){for(var e=0,t=this.parent.options.length;t--;)e+=this.parent.options[t].quantity*this.parent.options[t].price;return parseFloat(e).toFixed(2)},e.prototype.updatePriceAmount=function(){this.priceAmountElement.innerHTML="";var e=document.createElement("span");e.textContent="R$"+this.convertToComma(this.getPriceAmount()),this.priceAmountElement.appendChild(e)},e.prototype.updateQuantity=function(){this.quantityElement.innerHTML="";var e=document.createElement("span");e.textContent="QTD: "+this.getQuantity(),this.quantityElement.appendChild(e)},e.prototype.updateDetails=function(){this.updatePriceAmount(),this.updateQuantity()},e.prototype.addListeners=function(){var e=this;try{this.startButtonElement.addEventListener("click",function(){e.start()})}catch(t){}},e.prototype.getElements=function(){this.quantityElement=this.element.querySelector(this.config.quantityElementSelector),this.priceAmountElement=this.element.querySelector(this.config.priceAmountElementSelector),this.startButtonElement=this.element.querySelector(this.config.startButtonElementSelector)},e.prototype.init=function(){this.getElements(),this.addListeners(),this.updatePriceAmount()},e}(),TicketsOption=function(){function e(e,t){var i=this;this.element=e,this.parent=t,this.config={showMoreElementSelector:".TicketsOptions-showMore",showLessElementSelector:".TicketsOptions-showLess",showingMoreStateClass:"is-showingMore",selectElementSelector:".Select.Select--ticketOption"},this.quantity=0,this.id=this.element.dataset.optionId||"",this.description=this.element.dataset.description||"",this.price=this.getPrice(),this.onSelectChange=function(e){try{i.quantity=parseInt(e),i.parent.onOptionQuantityChange(),i.quantity>0&&ga("send","event",{eventCategory:"TicketOptionSelect",eventAction:"change",eventLabel:i.id})}catch(t){}},this.element&&this.init()}return e.prototype.addListeners=function(){var e=this;try{this.showMore.addEventListener("click",function(t){t.preventDefault(),e.element.classList.add(e.config.showingMoreStateClass)}),this.showLess.addEventListener("click",function(t){t.preventDefault(),e.element.classList.remove(e.config.showingMoreStateClass)})}catch(t){console.log(t)}},e.prototype.getElements=function(){var e=this;this.showLess=this.element.querySelector(this.config.showLessElementSelector),this.showMore=this.element.querySelector(this.config.showMoreElementSelector);var t=this.element.querySelector(this.config.selectElementSelector);t&&(this.select=new Select(t,e.onSelectChange))},e.prototype.getPrice=function(){try{return this.element.dataset.price?parseFloat(this.element.dataset.price).toFixed(2):0}catch(e){return 0}},e.prototype.init=function(){this.getElements(),this.addListeners()},e}(),Tickets=function(){function e(e){var t=this;this.element=e,this.config={optionElementSelector:".TicketsOption",checkoutElementSelector:".Tickets-checkout"},this.options=[],this.onOptionQuantityChange=function(){t.checkout.updateDetails();for(var e=0,i=t.options.length;i--;)e+=t.options[i].quantity;0==e?t.element.classList.add("is-empty"):t.element.classList.remove("is-empty")},this.element&&this.init()}return e.prototype.getElements=function(){var e=this.element.querySelector(this.config.checkoutElementSelector);e&&(this.checkout=new TicketsCheckout(e,this))},e.prototype.getOptions=function(){for(var e=this.element.querySelectorAll(this.config.optionElementSelector),t=e.length;t--;)this.options.push(new TicketsOption(e[t],this))},e.prototype.init=function(){this.getOptions(),this.getElements()},e}(),YouTubeVideo=function(){function e(e){var t=this;this.id=e,this.player=!1,this.elementID=!1,window.onYouTubeIframeAPIReady=function(){t.player=new YT.Player(t.elementID,t.config)},this.onPlayerReady=function(e){e.target.playVideo(),console.log(t.formatTime(t.getCurrentTime())),setInterval(function(){console.log(t.formatTime(t.getCurrentTime()))},1e3)},this.onPlayerStateChange=function(e){},this.config={height:"100%",width:"100%",videoId:t.id,playerVars:{autoplay:0,color:"white",disablekb:1,iv_load_policy:3,modestbranding:1,rel:0,showinfo:0,theme:"light"},events:{onReady:t.onPlayerReady,onStateChange:t.onPlayerStateChange}}}return e.prototype.pause=function(){this.player.pauseVideo()},e.prototype.play=function(){this.player.playVideo()},e.prototype.stop=function(){this.player.stopVideo()},e.prototype.formatTime=function(e){e=Math.round(e);var t=Math.floor(e/60),i=e-60*t;return i=i<10?"0"+i:i,t+":"+i},e.prototype.getCurrentTime=function(){return this.player.getCurrentTime()},e.prototype.getDuration=function(){return this.player.getDuration()},e}();